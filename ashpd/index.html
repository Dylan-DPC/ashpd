<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="ASHPD"><meta name="keywords" content="rust, rustlang, rust-lang, ashpd"><title>ashpd - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><script defer src="../main.js"></script>
    <noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="icon" href="https://raw.githubusercontent.com/bilelmoussaoui/ashpd/master/ashpd-demo/data/icons/com.belmoussaoui.ashpd.demo.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../ashpd/index.html"><div class="logo-container"><img src="https://raw.githubusercontent.com/bilelmoussaoui/ashpd/master/ashpd-demo/data/icons/com.belmoussaoui.ashpd.demo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../ashpd/index.html"><div class="logo-container">
                    <img src="https://raw.githubusercontent.com/bilelmoussaoui/ashpd/master/ashpd-demo/data/icons/com.belmoussaoui.ashpd.demo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Crate ashpd</a></h2><div class="sidebar-elems"><div class="block"><ul><li class="version">Version 0.2.0</li><li><a id="all-types" href="all.html">All Items</a></li></div></ul><section><div class="block"><ul><li><a href="#modules">Modules</a></li><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Definitions</a></li></ul></div></section><div id="sidebar-vars" data-name="ashpd" data-ty="mod" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../ashpd/index.html">
                        <img src="https://raw.githubusercontent.com/bilelmoussaoui/ashpd/master/ashpd-demo/data/icons/com.belmoussaoui.ashpd.demo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">ashpd</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/ashpd/lib.rs.html#1-42">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="ashpd"><a href="#ashpd">ASHPD</a></h2>
<p><a href="https://docs.rs/ashpd/"><img src="https://docs.rs/ashpd/badge.svg" alt="docs" /></a> <a href="https://crates.io/crates/ashpd"><img src="https://img.shields.io/crates/v/ashpd" alt="crates.io" /></a> <img src="https://github.com/bilelmoussaoui/ashpd/workflows/CI/badge.svg" alt="CI" /></p>
<p>ASHPD, acronym of Aperture Science Handheld Portal Device is a Rust &amp; <a href="https://gitlab.freedesktop.org/dbus/zbus">zbus</a> wrapper of
the XDG portals DBus interfaces. The library aims to provide an easy way to
interact with the various portals defined per the <a href="https://flatpak.github.io/xdg-desktop-portal/index.html">specifications</a>.
It provides an alternative to the C library <a href="https://github.com/flatpak/libportal">https://github.com/flatpak/libportal</a></p>
<h3 id="examples"><a href="#examples">Examples</a></h3>
<p>Ask the compositor to pick a color</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">ashpd::desktop::screenshot::ScreenshotProxy</span>;
<span class="kw">use</span> <span class="ident">ashpd::WindowIdentifier</span>;

<span class="kw">async</span> <span class="kw">fn</span> <span class="ident">run</span>() -&gt; <span class="ident">ashpd::Result</span><span class="op">&lt;</span>()<span class="op">&gt;</span> {
    <span class="kw">let</span> <span class="ident">connection</span> <span class="op">=</span> <span class="ident">zbus::Connection::session</span>().<span class="kw">await</span><span class="question-mark">?</span>;
    <span class="kw">let</span> <span class="ident">proxy</span> <span class="op">=</span> <span class="ident">ScreenshotProxy::new</span>(<span class="kw-2">&amp;</span><span class="ident">connection</span>).<span class="kw">await</span><span class="question-mark">?</span>;

    <span class="kw">let</span> <span class="ident">color</span> <span class="op">=</span> <span class="ident">proxy</span>.<span class="ident">pick_color</span>(<span class="kw-2">&amp;</span><span class="ident">WindowIdentifier::default</span>()).<span class="kw">await</span><span class="question-mark">?</span>;
    <span class="macro">println!</span>(<span class="string">&quot;({}, {}, {})&quot;</span>, <span class="ident">color</span>.<span class="ident">red</span>(), <span class="ident">color</span>.<span class="ident">green</span>(), <span class="ident">color</span>.<span class="ident">blue</span>());
    <span class="prelude-val">Ok</span>(())
}</code></pre></div>
<p>Start a PipeWire stream from the user’s camera</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">ashpd::desktop::camera::CameraProxy</span>;

<span class="kw">pub</span> <span class="kw">async</span> <span class="kw">fn</span> <span class="ident">run</span>() -&gt; <span class="ident">ashpd::Result</span><span class="op">&lt;</span>()<span class="op">&gt;</span> {
    <span class="kw">let</span> <span class="ident">connection</span> <span class="op">=</span> <span class="ident">zbus::Connection::session</span>().<span class="kw">await</span><span class="question-mark">?</span>;
    <span class="kw">let</span> <span class="ident">proxy</span> <span class="op">=</span> <span class="ident">CameraProxy::new</span>(<span class="kw-2">&amp;</span><span class="ident">connection</span>).<span class="kw">await</span><span class="question-mark">?</span>;

    <span class="kw">if</span> <span class="ident">proxy</span>.<span class="ident">is_camera_present</span>().<span class="kw">await</span><span class="question-mark">?</span> {
        <span class="ident">proxy</span>.<span class="ident">access_camera</span>().<span class="kw">await</span><span class="question-mark">?</span>;
        <span class="kw">let</span> <span class="ident">remote_fd</span> <span class="op">=</span> <span class="ident">proxy</span>.<span class="ident">open_pipe_wire_remote</span>().<span class="kw">await</span><span class="question-mark">?</span>;
        <span class="comment">// pass the remote fd to GStreamer for example</span>
    }
    <span class="prelude-val">Ok</span>(())
}</code></pre></div>
<h3 id="optional-features"><a href="#optional-features">Optional features</a></h3><div><table><thead><tr><th>Feature</th><th>Description</th></tr></thead><tbody>
<tr><td>log</td><td>Record various debug information using the <code>tracing</code> library</td></tr>
<tr><td>feature_gtk3</td><td>Implement <code>From&lt;Color&gt;</code> for <a href="https://gtk-rs.org/gtk3-rs/stable/latest/docs/gdk/struct.RGBA.html"><code>gdk3::RGBA</code></a></td></tr>
<tr><td></td><td>Provides <code>WindowIdentifier::from_window</code> that takes a <a href="https://gtk-rs.org/gtk3-rs/stable/latest/docs/gdk/struct.Window.html"><code>IsA&lt;gdk3::Window&gt;</code></a></td></tr>
<tr><td>feature_gtk4</td><td>Implement <code>From&lt;Color&gt;</code> for <a href="https://gtk-rs.org/gtk4-rs/stable/latest/docs/gdk4/struct.RGBA.html"><code>gdk4::RGBA</code></a></td></tr>
<tr><td></td><td>Provides <code>WindowIdentifier::from_native</code> that takes a <a href="https://gtk-rs.org/gtk4-rs/stable/latest/docs/gtk4/struct.Native.html"><code>IsA&lt;gtk4::Native&gt;</code></a></td></tr>
<tr><td>feature_pipewire</td><td>Provides <code>ashpd::desktop::camera::pipewire_node_id</code> that helps you retrieve the PipeWire Node ID to use with the file descriptor returned by the camera portal</td></tr>
<tr><td>raw_handle</td><td>Provides <code>WindowIdentifier::from_raw_handle</code> and <code>WindowIdentifier::as_raw_handle</code> for <a href="https://lib.rs/crates/raw-window-handle">raw-window-handle</a> crate</td></tr>
</tbody></table>
</div><h3 id="demo"><a href="#demo">Demo</a></h3>
<p>The library comes with a <a href="./ashpd-demo">demo</a> built using the <a href="https://gtk-rs.org/gtk4-rs">GTK 4 Rust bindings</a> and previews most of the portals. It is meant as a test case for the portals (from a distributor perspective) and as a way for the developers to see which portals exists and how to integrate them into their application using ASHPD.</p>
<a href="https://flathub.org/apps/details/com.belmoussaoui.ashpd.demo">
<img src="https://flathub.org/assets/badges/flathub-badge-i-en.png" width="190px" />
</a></div></details><h2 id="reexports" class="small-section-header"><a href="#reexports">Re-exports</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left import-item"><code>pub use <a class="mod" href="https://docs.rs/enumflags2/0.6/enumflags2/index.html" title="mod enumflags2">enumflags2</a>;</code></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left import-item"><code>pub use <a class="mod" href="https://docs.rs/zbus/latest/zbus/index.html" title="mod zbus">zbus</a>;</code></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left import-item"><code>pub use zbus::<a class="mod" href="https://docs.rs/zvariant/latest/zvariant/index.html" title="mod zvariant">zvariant</a>;</code></div><div class="item-right docblock-short"></div></div></div><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="desktop/index.html" title="ashpd::desktop mod">desktop</a></div><div class="item-right docblock-short"><p>Interact with the user’s desktop such as taking a screenshot, setting a
background or querying the user’s location.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="documents/index.html" title="ashpd::documents mod">documents</a></div><div class="item-right docblock-short"><p>Interact with the documents store or transfer files across apps.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="flatpak/index.html" title="ashpd::flatpak mod">flatpak</a></div><div class="item-right docblock-short"><p>Spawn commands outside the sandbox or monitor if the running application has
received an update &amp; install it.</p>
</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Error.html" title="ashpd::Error enum">Error</a></div><div class="item-right docblock-short"><p>The error type for ashpd.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.PortalError.html" title="ashpd::PortalError enum">PortalError</a></div><div class="item-right docblock-short"><p>An error type that describes the various DBus errors.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.WindowIdentifier.html" title="ashpd::WindowIdentifier enum">WindowIdentifier</a></div><div class="item-right docblock-short"><p>Most portals interact with the user by showing dialogs.
These dialogs should generally be placed on top of the application window
that triggered them. To arrange this, the compositor needs to know about the
application window. Many portal requests expect a <a href="enum.WindowIdentifier.html" title="WindowIdentifier"><code>WindowIdentifier</code></a> for
this reason.</p>
</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.is_sandboxed.html" title="ashpd::is_sandboxed fn">is_sandboxed</a></div><div class="item-right docblock-short"><p>Check whether the application is running inside a sandbox.</p>
</div></div></div><h2 id="types" class="small-section-header"><a href="#types">Type Definitions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="type" href="type.Result.html" title="ashpd::Result type">Result</a></div><div class="item-right docblock-short"><p>Alias for a <a href="type.Result.html" title="Result"><code>Result</code></a> with the error type <code>ashpd::Error</code>.</p>
</div></div></div></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="ashpd" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.61.0-nightly (38a0b81b1 2022-03-06)" ></div>
</body></html>